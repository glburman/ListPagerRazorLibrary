@page
@namespace ListPagerExamples.Areas.ViewComponent.Pages
@model VCGetModel
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    Layout = "_LayoutForExamples";
    ViewData["Title"] = "ListPager Example - GET";
    var pager = Model.Parameters.Pager;
    pager.ShowRecordsOf = pager.IsFiltered;
    pager.ShowPageOf = !pager.IsFiltered;
    pager.ShowDropDown = pager.PageCount > pager.MaxPagerLinks + 1;
}
@section Scripts{
    <script>
    //Page scope, not module scope
    let pager
    let pagerState = @Json.Serialize(@pager);
    let filter = '@Model.Parameters.SearchTerm';
    const constants = {}
    </script>
    <script type="module">
        import Pager from "/js/pager.js"    //path in ListPagerRazorLibrary
        pager = new Pager(pagerState, {})
        document.addEventListener(Pager.constants.pagingEventName, (e) => {
            let { pageNumber, pageSize } = { ...e.detail.ListPagerModel }
            let filter = document.getElementById("filter").value
            window.location.search = `PageNumber=${pageNumber}&PageSize=${pageSize}&search=${filter}`
        })
    </script>
}

@section Notes{
    <p>
        In this example the <code>ListPagerPageOf</code> ("Page N of T") element is shown only when the list is not filtered.
        The converse is true of the <code>ListPagerRecords</code> ("N Rows of T") element.
        The Search function searches for Last Names containing the search term.
    </p>
    <p>
        The dropdown may or may not be displayed, depending on the page count, whether filtered or not. 
        Search for "a" and it is displayed because there are 7 pages, 2 more than are shown in the 
        numbered links. Search for "J" and it is not:
    </p>
    <p class="ml-3"><code>pager.ShowDropDown = pager.PageCount > pager.MaxPagerLinks + 1;</code></p>
    <p>
        The only override in this example is the <code>_ListPagerPageOf</code> Partial View which is overriden by <code>ListPagerExamples/Pages/Shared/_ListPagerPageOf</code>
        which simply changes the text color to "text-danger" (aka Red).
    </p>
}

<div class="d-flex justify-content-center">
    <partial name="_ListPager" model="@pager" />
</div>
<div class="d-flex justify-content-end col-md-11">
    <partial name="_ListFilterPartial" model='@Model.Parameters.SearchTerm' />
</div>
<div class="d-flex justify-content-center">
    <div class="col-md-10">
        <partial name="_ListTable" model="@Model.Bloggers" />
    </div>
</div>
